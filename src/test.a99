       limi 0
       lwpi wrksp
       bl   @setup_environment
       bl   @ti_draw_playfield
       clr  bc
       clr  hl
loop:
       bl   @vsync
       bl   @vsync
       bl   @vsync
       bl   @vsync
       bl   @vsync
       bl   @vsync
       bl   @vsync
       bl   @vsync

       mov  bc,tmp1
       li   tmp2,3
       bl   @ti_draw_door_1

       clr  tmp1
       mov  bc,tmp2
       andi tmp2,15
       sla  tmp2,1
       mov  @door_frames(tmp2),tmp2
       bl   @ti_draw_door_2

       mov  bc,tmp1
       li   tmp2,2
       bl   @ti_draw_door_3

       inc  bc
       ci   bc,>28
       jne  loop

       mov  hl,tmp0
       andi tmp0,1
       jne  main1
       bl   @ti_scroll_left
       jmp  main2
main1:
       bl   @ti_scroll_right
main2:
       inc  hl

       clr  bc
       jmp  loop

door_frames:
       data 0,0,0,0,1,2,3,3,3,3,3,3,2,2,1,0

